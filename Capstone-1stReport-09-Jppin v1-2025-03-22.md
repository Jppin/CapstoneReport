<!-- Template for PROJECT REPORT of CapstoneDesign 2025-2H, initially written by khyoo -->
<!-- 본 파일은 2025년도 컴공 졸업프로젝트의 <1차보고서> 작성을 위한 기본 양식입니다. -->
<!-- 아래에 "*"..."*" 표시는 italic체로 출력하기 위해서 사용한 것입니다. -->
<!-- "내용"에 해당하는 부분을 지우고, 여러분 과제의 내용을 작성해 주세요. -->

# Team-Info
| (1) 과제명 | *임산부 대상 복약정보 연동·RAG 기반 개인맞춤형 영양보충 가이드 시스템* |
|:---  |---  |
| (2) 팀 번호 / 팀 이름 | 09-Jppin |
| (3) 팀 구성원 | 강명진(2217001): 리더, FE/BE<br> 김주예(2076086): 팀원, FE/BE <br> 유현서(2271041) : 팀원, FE/BE			 |
| (4) 팀 지도교수 | 심재형 교수님 |
| (5) 과제 분류 | 산학 |
| (6) 과제 키워드 | 임산부, RAG, 맞춤형 영양보충 가이드, 의약품 복용 내역  |
| (7) 과제 내용 요약 | 본 프로젝트는 임산부를 위한 맞춤형 영양 성분 추천과 식단 섭취 가이드 서비스를 개발하는 것을 목표로 한다.<br>사용자의 건강 상태와 임신 주차 정보를 바탕으로, 권장 및 주의가 필요한 영양소를 도출하고 이에 따라 개인 맞춤형 식단 가이드를 생성한다.<br>또한, 약물과 영양소 간의 상호작용까지 고려하여 더욱 정밀한 영양 관리가 가능하도록 설계되었다.<br>이를 통해 임산부는 효율적으로 영양을 관리하고, 건강한 임신을 유지할 수 있으며,<br>최종적으로는 정보 접근성과 사용 편의성을 높여 보다 쉽고 정확한 건강관리를 실현하는 것을 지향한다. |

<br>

# Project-Summary
| 항목 | 내용 |
|:---  |---  |
| (1) 문제 정의 | **Pain Point**<br>1. **개인 맞춤 영양성분 추천의 부재**: 임산부는 임신 주차 및 개인 건강 상태에 따라 필요한 영양 성분이 달라지지만, 현재 대부분의 정보는 일률적이며 일반화되어 있다. 이로 인해 개별적인 요구를 반영한 맞춤형 추천이 부족하고, 본인에게 필요한 정보나 가이드를 스스로 찾아야 하는 어려움이 있다.<br>2. **복잡한 영양·식단 관리의 어려움**: 약물 복용과 영양소 간 상호작용을 함께 고려하며 균형 잡힌 식단을 구성하기란 일반 사용자에게 매우 어렵다. 특히 임산부는 하루 영양 섭취 가이드를 스스로 짜기 어려우며, 복잡한 조건(약물, 질환, 영양 균형 등)을 고려한 체계적인 관리 시스템이 부족하다.<br>3. **건강 관심사 반영 부족**: 임산부마다 체중 관리, 특정 영양소 보충, 기저 질환 또는 임신 합병증 등 다양한 건강 관심사가 존재하지만, 기존 서비스들은 이를 충분히 반영하지 못한다. 이에 따라 개인화된 정보 제공이 어려워지고, 본인에게 적합한 영양 가이드를 찾는 데 한계가 있다.<br><br>**Target Customer 정의**<br>1. **대상**: 임신 중 본인과 태아의 건강에 높은 관심을 가지며, 개인 건강 상태나 복용 약물, 건강 고민 등을 고려한 **맞춤형 영양성분 및 식단 가이드**가 필요한 임산부.<br>예: 임신성 당뇨, 고혈압, 철분 결핍 등 합병증을 겪고 있거나 약물을 복용 중인 경우.<br>2. **고객의 필요성**: 임신 삼분기별로 변화하는 영양 요구와 약물-영양소 상호작용을 함께 고려한 **정확하고 신뢰할 수 있는 가이드**가 필요하다. 임산부는 ‘무엇을, 어떻게, 얼마나’ 섭취해야 하는지에 대한 명확한 정보를 원하며, 기존의 일괄적인 정보로는 이를 충족하기 어렵다. 따라서 **개인 건강 정보에 기반한 영양 추천과 섭취 가이드를 제공하는 맞춤형 시스템**이 필요하다. |
| (2) 기존연구와의 비교 | **기존 서비스와 차별점**<br>기존 임산부 관련 앱들은 주로 일반적인 정보 제공, 전문가 상담, 기록 기능 위주로 구성되어 있으며, 사용자가 직접 질문하거나 정보를 검색해야 원하는 내용을 얻는 방식이다. 일부 앱은 매주 아기 발달 정보, 출산 준비물 리스트 등을 제공하지만, **개인의 건강 상태와 임신 주차에 따른 맞춤형 정보는 부족**한 편이다.<br><br>이에 비해 본 서비스는 사용자의 건강 정보(질환, 임신 주차, 약물 복용 등)를 바탕으로 **자동화된 맞춤형 영양 성분 추천과 식단 가이드를 제공**한다. 사용자가 별도로 질문하지 않아도 현재 상태에 맞는 정보가 사전 제공되며, 실시간으로 권장 영양소와 주의 성분, 식단 예시를 카드 형태로 확인할 수 있다.<br><br>예를 들어, 임신 12주차에 접어든 사용자는 태반 형성을 돕기 위한 철분 섭취 가이드를 자동으로 제공받을 수 있고, 복용 중인 약물이 비타민 B12 흡수를 저해하는 경우 주의 카드도 함께 표시되어 보다 정밀한 영양 관리가 가능하다.<br><br>**본 서비스의 장점**<br>1. **자동화된 개인 맞춤형 정보 제공**: 일반적인 정보에 그치지 않고, 사용자의 건강 상태와 임신 주차를 기반으로 한 **즉시 활용 가능한 가이드**를 자동 제공하여 정보 탐색의 번거로움을 줄여준다.<br>2. **심층적이고 통합적인 영양 관리**: 단순 추천을 넘어, **약물-영양소 상호작용**과 개인 건강 고민을 종합 반영하여 보다 정밀한 맞춤형 가이드를 제공한다. |
| (3) 제안 내용 | 1. 식단–영양소–영양제 연결형 상세 가이드 제공: 사용자 건강 상태 및 복약 정보를 바탕으로, 섭취해야 할 영양소와 피해야 할 성분을 연결하여 설명하고, 금기 사항과 복약 주의사항까지 함께 안내함<br>2. 임신 주차와 개인 건강 기록(복약 정보, 건강 고민, 임신 합병증 여부 등)에 기반한 섭취 가이드를 자동 생성하여, 개인 상황에 맞는 정보를 실시간 제공함<br>3. 영양소 추천 결과를 반영해 맞춤형 식단을 구성하고, 각 식사에 포함된 성분과 섭취 이유를 함께 안내하는 상세 식단 가이드를 제공함<br>4. 텍스트 정보만으로 부족한 경우를 보완하기 위해, 사용자의 건강 관심 키워드 기반 YouTube 영상 추천 기능을 통해 정보 탐색을 유도하고 앱 내 재생 기능을 제공함 |
| (4) 기대효과 및 의의 | 본 프로젝트는 임산부의 건강 관리와 영양 섭취에 있어 기존 시스템의 한계를 넘어, 개인 건강 상태와 임신 주차를 반영한 **맞춤형 정보 제공**에 중점을 둔다.<br>특히, 삼분기별 변화하는 영양 요구와 개별 건강 관심사를 반영하여 **영양소 추천과 식단 가이드**를 자동 생성함으로써, 보다 정확하고 체계적인 영양 관리가 가능하다.<br>이를 통해 임산부가 겪는 복잡한 정보 탐색과 영양 설계의 부담을 줄이고, 실질적인 건강 관리에 도움을 줄 수 있다는 점에서 **현실적인 활용 가치와 사회적 의의**를 갖는다. |
| (5) 주요 기능 리스트 | **복약과 영양의 통합 관리**<br>1. OCR 기반 복약 정보 수집, 파싱 및 DB화<br>2. 약물–영양소 간 상호작용 분석 및 충돌 알림 제공<br>3. 사용자 개인 복약/영양제 정보 조회 기능 제공<br><br>**개인 맞춤형 가이드 제공**<br>1. 임신 주차, 건강 상태 등 사용자 정보 입력 및 수정 기능<br>2. 보유 정보를 바탕으로 프롬프트 엔지니어링을 활용한 맞춤 복용 가이드 생성<br><br>**신뢰성 있는 정보 기반 설계**<br>1. 검증된 데이터셋을 활용한 RAG 구축 및 설명 카드 자동 생성<br>2. 영양성분 및 약품 관련 상세 정보 열람 기능<br><br>**가이드 콘텐츠 확장 기능**<br>1. 사용자 관심 키워드를 기반으로 한 유튜브 영상 추천 및 앱 내 재생 기능 제공 |

<br>
 
# Project-Design & Implementation
| 항목 | 내용 |
|:---|:---|
| (1) 요구사항 정의 | 임산부 대상의 복약 기반 맞춤형 영양 가이드를 제공하기 위해, 기능별 요구사항, 클래스 구조, 사용자 흐름, DB 설계를 바탕으로 요구사항을 정의하였다.<br><br> 1. 기능별 상세 요구사항<br>~~- 건강 정보 입력 (임신 여부, 주차, 질환, 건강고민 등)~~<br>*- 건강 정보 입력 (임신 여부, 주차, 질환, 건강고민 등): 사용자의 건강 상태를 정확히 파악하여 복약 정보 분석 및 영양소 추천의 기준값으로 활용됨*<br><br>~~- 복약 정보 입력 및 OCR 기반 약물 성분 추출~~<br>*- 복약 정보 입력 및 OCR 기반 약물 성분 추출: 사용자의 약물 복용 이력을 자동화 방식으로 수집하고, 해당 정보를 성분 분석에 활용하기 위함*<br><br>~~- 권장/주의 성분 분류 및 카드 제공~~<br>*- 권장/주의 성분 분류 및 카드 제공: 약물 성분과 건강 상태에 따라 필터링된 영양소 정보를 시각적으로 구분하여 사용자에게 쉽게 제공하기 위함*<br><br>~~- 설명 카드 제공~~<br>*- 설명 카드 제공: 추천된 영양 성분의 복용 필요성과 주의사항에 대한 배경 지식을 제공하여 신뢰도 높은 가이드를 형성함*<br><br>~~- RAG 기반 식단 가이드 및 보충 가이드 제공~~<br>*- RAG 기반 식단 가이드 및 보충 가이드 제공: 사용자 정보와 권장 영양소를 기반으로 생성된 신뢰성 있는 문서 기반 식단 예시를 통해 실제 섭취 계획을 세울 수 있도록 돕기 위함*<br><br>~~- 관심 키워드 기반 YouTube 영상 추천 및 재생~~<br>*- 관심 키워드 기반 YouTube 영상 추천 및 재생: 사용자의 건강 관심사와 연결된 짧은 영상 콘텐츠를 제공함으로써 정보 접근성을 높이고 앱 체류 시간을 증가시킴*<br><br>![유스케이스 다이어그램](https://raw.githubusercontent.com/Jppin/CapstoneReport/main/images/UseCase.png) <br><br> 2.클래스 및 DB 설계 요약<br>- 핵심 클래스는 User, Medicine, Nutrient, GuideText, Recommendation, FoodGuide, Video로 구성되며, 각 기능별 역할에 따라 분리됨<br><br>![ERD](https://raw.githubusercontent.com/Jppin/CapstoneReport/main/images/ERD.png)|
| (2) 전체 시스템 구성 | 본 시스템은 React Native 기반 모바일 앱과 Node.js 기반 백엔드 서버로 구성되며, 사용자의 건강 정보 및 약물 복용 이력을 바탕으로 맞춤형 영양 성분 추천과 식단 가이드를 제공한다. 복약 정보는 OCR을 통해 자동 수집되며, LangChain 기반 RAG 구조와 GPT API를 활용해 개인화된 안내 문장을 생성한다.<br><br>전체 시스템은 사용자의 입력 → 서버 처리 → 외부 API 활용 → 결과 반환이라는 흐름을 바탕으로 구성되어 있다. 사용자가 앱에서 입력하거나 업로드한 정보는 Node.js 서버로 전달되며, 서버는 이를 OCR 및 데이터베이스 분석을 통해 처리하고, 필요 시 외부 API를 호출한다. 각 기능은 독립된 모듈로 구성되어 있으며, 전처리-분석-생성의 단계가 모듈 간 흐름을 따라 작동한다.<br><br>주요 구성 요소 및 역할<br>- React Native 앱: 사용자 정보 입력, 약물 이미지 업로드, 권장/주의 영양소 및 섭취 가이드 확인 UI 제공<br>- Node.js + Express 서버: OCR 결과 처리, 성분 분석, 추천 로직 실행 및 RAG 기반 식단 생성 기능 처리<br>- MongoDB Atlas: 사용자 정보, 복약 이력, 권장·주의 성분, 식단 추천 결과 등 주요 데이터를 저장하는 비정형 데이터베이스<br>- Redis: 세션 유지 및 OCR/추천 결과 등 반복 사용 데이터 캐싱 처리<br>- CLOVA OCR API: 약봉투 이미지에서 의약품명 및 복용 정보 추출<br>- LangChain + OpenAI GPT-4o API: 사용자의 상황에 적합한 섭취 가이드 문장을 생성하기 위한 프롬프트 엔지니어링 및 문서 검색 수행<br>- Vector DB: 식단 가이드를 위한 문서 벡터화 및 검색을 위한 임베딩 저장소<br>- YouTube Data API: 사용자의 건강 관심 키워드를 기반으로 관련 콘텐츠를 탐색하고 앱 내에서 영상 재생<br><br>주요 흐름 및 기능별 데이터 처리<br>각 기능 흐름은 화살표 색상으로 구분되며 다음과 같다:<br>① 약 보관함 기능 (연두색): 이미지 업로드 → OCR 텍스트 추출 → 약물명 파싱 → 성분 분석 및 권장/주의 성분 도출<br>② 식단 생성 기능 (분홍색): 권장 성분 + 건강 정보 기반 RAG 쿼리 → GPT 호출 → 섭취 가이드 생성<br>③ 영양성분 추천 기능 (노란색): 사용자 초기 정보 기반 권장/주의 성분 분석 → 이유 카드 형태로 반환<br><br><br>시스템 아키텍처<br>![시스템 아키텍처](https://raw.githubusercontent.com/Jppin/CapstoneReport/main/images/System_Architecture.png) <br>배포 환경으로는 GitHub Actions를 통한 코드 관리 및 자동 배포, Docker를 통한 서버 컨테이너화, EC2를 통한 실행 환경 구축이 사용되었다. |
| (3) 주요 엔진 및 기능 설계 | 본 시스템은 기능 단위가 아닌 모듈 단위로 구현이 구분되어 있으며, 주요 엔진은 ① OCR 기반 복약 정보 처리 모듈과 ② LangChain 기반 RAG 텍스트 생성 모듈로 나뉜다. 아래는 각 모듈의 목적, 구조, 동작 방식에 대한 설명이다.<br><br><br>1. OCR 기반 복약 정보 처리 모듈<br>목적: 사용자가 약봉투 또는 일반약 외포장 사진을 업로드했을 때, 해당 이미지에서 약물 정보를 자동 추출하여 이후 분석에 활용 가능한 구조화된 형태로 가공한다.<br><br>동작 방식 및 구성요소:<br>- 업로드된 이미지는 프론트에서 FormData 형태로 백엔드로 전송됨<br>- Node.js 서버는 CLOVA OCR API를 호출해 이미지로부터 텍스트를 추출함<br>- 추출된 텍스트 중 불필요한 정보를 제외하고 약물명, 용량, 복용법 등을 정규표현식 + LLM 후처리로 분리함<br>- 약물명 기준으로 내부 약물 DB에서 성분 정보를 조회하고, 복용 중인 약물과의 상호작용 기반으로 권장/주의 성분을 분류함<br><br>현재 구현 현황:<br>- CLOVA OCR 호출 및 결과 파싱, 약물명 정제, 내부 DB와의 매핑은 완료<br>- 복용법 및 용량의 구조화, 성분 간 복합 금기 조건 자동 인식 로직은 현재 테스트 중이며, 일부 샘플에서 실패 케이스 존재 (완성도 약 90%)<br><br><br><br>2. RAG 기반 식단 및 섭취 가이드 생성 모듈<br>목적: 사용자의 건강 상태와 권장 영양성분을 바탕으로 실제로 섭취할 수 있는 식단과 보충 가이드 문장을 자동 생성해 카드 형태로 제공한다.<br><br>동작 방식:<br>- 검증된 식이자료를 수집하여 문서로 정리하고 chunking → 임베딩 수행<br>- Ada-002 기반 벡터 DB에 저장하고, LangChain의 RetrievalQA 구조로 연결<br>- 사용자 상태(임신 주차, 건강 고민 등)와 권장 성분 정보를 기반으로 프롬프트 구성<br>- GPT-4o 호출 결과로 아침/점심/저녁/간식 식단 예시 + 보충 가이드 텍스트 생성<br><br>현재 구현 현황: 전체 RAG 흐름 및 GPT 호출 파이프라인 구현 완료. 프롬프트 분기 처리 및 응답 포맷도 카드형 UI에 맞춰 안정화 완료.<br><br><br><br>3. 건강 관심 키워드 기반 YouTube 콘텐츠 추천 모듈<br>목적: 앱 체류 시간 향상 및 정보 탐색 경험 향상을 위해, 사용자의 건강 관심 키워드 기반으로 짧은 영상(Shorts 포함)을 추천하고, 앱 내에서 재생할 수 있도록 한다.<br><br>동작 방식:<br>- 사용자가 입력한 건강 관심 키워드를 기준으로, 서버에서 YouTube Data API 호출<br>- search.list 메서드를 활용해 videoDuration=short 조건으로 영상 검색<br>- 썸네일/제목/URL 데이터를 정제하여 프론트로 전송<br>- React Native 앱 내 썸네일 그리드 UI에 표시되고, 탭 시 WebView 방식으로 영상이 앱 내부에서 재생됨<br><br>현재 구현 현황: 영상 추천, 썸네일 출력, 영상 재생까지 전 기능 100% 구현 완료<br>특이사항: 사용자가 ‘좋아요’ 표시한 영상을 DB에 저장하고, 이후 별도 탭에서 다시 확인할 수 있는 기능까지 포함되어 있음.<br><br><br><br>모듈 간 연계 구조:<br>OCR 분석 결과에서 도출된 성분이 가이드 생성 모듈과 연결되고, 사용자 초기 입력 정보(건강 고민)는 YouTube 추천 모듈과 연계된다. 세 모듈은 각각 독립적인 흐름을 가지되, 사용자 맞춤형 정보 제공이라는 공통 목적을 향해 함께 동작한다. |
| (4) 주요 기능과 SW 모듈 간 연관성 설명 | 본 시스템은 주요 기능별로 명확히 분리된 소프트웨어 모듈 구조를 가지며, 각각의 기능은 내부 모듈과 1:1 또는 1:N 관계로 매핑된다. 아래는 핵심 기능과 그에 대응하는 주요 모듈 및 구현 흐름이다.<br><br>[기능 1] OCR 기반 복약 정보 등록 및 조회<br>연관 모듈: OCRProcessor, DrugParser, NutrientAnalyzer, MongoDB 연결모듈<br>동작 흐름:<br>- 사용자가 약봉투 이미지를 업로드하면, OCRProcessor가 CLOVA OCR API를 호출하여 텍스트를 추출<br>- 추출된 텍스트를 DrugParser에서 정제하고 약물명을 식별<br>- 해당 약물명은 DB와 매핑되어 성분을 조회하고, NutrientAnalyzer가 사용자 정보와 교차 분석하여 권장/주의 성분을 판별함<br>- 분석 결과는 프론트에 카드 형태로 출력되며, MongoDB에 저장되어 이후 '내 복약함' 탭에서 사용자가 등록 내역을 조회 가능<br><br>[기능 2] 맞춤 복용 가이드 및 식단 생성<br>연관 모듈: LangChain RAG 파이프라인, PromptConstructor, GPTHandler, VectorDBWrapper<br>동작 흐름:<br>- 사용자가 앱 최초 실행 시 입력한 건강 정보(임신 주차, 질환, 건강 고민 등)는 MongoDB에 저장되며, 이후 모든 추천 흐름에서 자동으로 사용됨<br>- 도출된 권장 성분과 함께 PromptConstructor가 LangChain 기반 프롬프트를 구성<br>- VectorDBWrapper는 RAG용 문서를 벡터 검색하고, GPTHandler가 GPT-4o를 호출하여 섭취 가이드 및 식단 예시 문장을 생성함<br>- 응답 결과는 프론트에서 카드 형태로 사용자에게 전달됨<br><br>[기능 3] 건강 관심 키워드 기반 YouTube 영상 추천<br>연관 모듈: KeywordManager, YouTubeFetcher, VideoFormatter, FrontendGridRenderer<br>동작 흐름:<br>- 사용자가 입력한 건강 관심 키워드는 KeywordManager에 저장되며, 백엔드는 이를 기반으로 YouTubeFetcher로 YouTube Data API를 호출<br>- 결과는 VideoFormatter를 통해 썸네일, 제목, 링크 형태로 정제되어 프론트로 전송됨<br>- FrontendGridRenderer는 썸네일 리스트를 출력하고, 클릭 시 앱 내 WebView로 재생함<br>- 사용자가 ‘좋아요’를 누른 영상은 DB에 저장되어 ‘좋아요 탭’에서 다시 확인 가능<br><br>기능 간 통합 및 제어 흐름:<br>- OCR 기능은 섭취 가이드 생성의 입력값을 제공하는 선행 기능이며, 유저 입력 정보는 모든 기능에 걸쳐 공통 기반 데이터로 작동함<br>- YouTube 추천 기능은 가이드/식단 기능과 직접 연결되진 않지만, 건강 관심사 기반 큐레이션 기능으로 사용자 맞춤도와 흥미 유지를 도움<br>- GPT 인터페이스는 단순 API 호출이 아닌, LangChain 기반 프롬프트 생성 – 문서 검색 – 조건 분기 응답의 체계적 구조로 구현되어 있음<br><br>이러한 기능–모듈 매핑을 통해 각 기능은 독립성과 유연성을 확보하면서도, 전체 시스템 흐름 내에서 일관된 데이터 흐름과 사용자 경험을 제공하도록 설계되었다. |
| (5) 기타 | 현재 복약 이미지가 흐리거나 글자가 왜곡된 경우 OCR 정확도에 영향을 줄 수 있어, 향후 유사 샘플 학습 또는 보정 로직 개선을 고려할 예정임. |
<br>
