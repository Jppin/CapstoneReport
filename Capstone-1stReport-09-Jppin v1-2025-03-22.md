<!-- Template for PROJECT REPORT of CapstoneDesign 2025-2H, initially written by khyoo -->
<!-- 본 파일은 2025년도 컴공 졸업프로젝트의 <1차보고서> 작성을 위한 기본 양식입니다. -->
<!-- 아래에 "*"..."*" 표시는 italic체로 출력하기 위해서 사용한 것입니다. -->
<!-- "내용"에 해당하는 부분을 지우고, 여러분 과제의 내용을 작성해 주세요. -->

# Team-Info
| (1) 과제명 | *임산부 대상 복약정보 연동·RAG 기반 개인맞춤형 영양보충 가이드 시스템* |
|:---  |---  |
| (2) 팀 번호 / 팀 이름 | 09-Jppin |
| (3) 팀 구성원 | 강명진(2217001): 리더, FE/BE<br> 김주예(2076086): 팀원, FE/BE <br> 유현서(2271041) : 팀원, FE/BE			 |
| (4) 팀 지도교수 | 심재형 교수님 |
| (5) 과제 분류 | 산학 |
| (6) 과제 키워드 | 임산부, RAG, 맞춤형 영양보충 가이드, 의약품 복용 내역  |
| (7) 과제 내용 요약 | 본 프로젝트는 임산부를 위한 맞춤형 영양 성분 추천과 식단 섭취 가이드 서비스를 개발하는 것을 목표로 한다.<br>사용자의 건강 상태와 임신 주차 정보를 바탕으로, 권장 및 주의가 필요한 영양소를 도출하고 이에 따라 개인 맞춤형 식단 가이드를 생성한다.<br>또한, 약물과 영양소 간의 상호작용까지 고려하여 더욱 정밀한 영양 관리가 가능하도록 설계되었다.<br>이를 통해 임산부는 효율적으로 영양을 관리하고, 건강한 임신을 유지할 수 있으며,<br>최종적으로는 정보 접근성과 사용 편의성을 높여 보다 쉽고 정확한 건강관리를 실현하는 것을 지향한다. |

<br>

# Project-Summary
| 항목 | 내용 |
|:---  |---  |
| (1) 문제 정의 | **Pain Point**<br>1. **개인 맞춤 영양성분 추천의 부재**: 임산부는 임신 주차 및 개인 건강 상태에 따라 필요한 영양 성분이 달라지지만, 현재 대부분의 정보는 일률적이며 일반화되어 있다. 이로 인해 개별적인 요구를 반영한 맞춤형 추천이 부족하고, 본인에게 필요한 정보나 가이드를 스스로 찾아야 하는 어려움이 있다.<br>2. **복잡한 영양·식단 관리의 어려움**: 약물 복용과 영양소 간 상호작용을 함께 고려하며 균형 잡힌 식단을 구성하기란 일반 사용자에게 매우 어렵다. 특히 임산부는 하루 영양 섭취 가이드를 스스로 짜기 어려우며, 복잡한 조건(약물, 질환, 영양 균형 등)을 고려한 체계적인 관리 시스템이 부족하다.<br>3. **건강 관심사 반영 부족**: 임산부마다 체중 관리, 특정 영양소 보충, 기저 질환 또는 임신 합병증 등 다양한 건강 관심사가 존재하지만, 기존 서비스들은 이를 충분히 반영하지 못한다. 이에 따라 개인화된 정보 제공이 어려워지고, 본인에게 적합한 영양 가이드를 찾는 데 한계가 있다.<br><br>**Target Customer 정의**<br>~~1. **대상**: 임신 중 본인과 태아의 건강에 높은 관심을 가지며, 개인 건강 상태나 복용 약물, 건강 고민 등을 고려한 **맞춤형 영양성분 및 식단 가이드**가 필요한 임산부.<br>예: 임신성 당뇨, 고혈압, 철분 결핍 등 합병증을 겪고 있거나 약물을 복용 중인 경우.<br>2. **고객의 필요성**: 임신 삼분기별로 변화하는 영양 요구와 약물-영양소 상호작용을 함께 고려한 **정확하고 신뢰할 수 있는 가이드**가 필요하다. 임산부는 ‘무엇을, 어떻게, 얼마나’ 섭취해야 하는지에 대한 명확한 정보를 원하며, 기존의 일괄적인 정보로는 이를 충족하기 어렵다. 따라서 **개인 건강 정보에 기반한 영양 추천과 섭취 가이드를 제공하는 맞춤형 시스템**이 필요하다.~~<br>*1. 주요 대상<br> 임신 중 본인과 태아의 건강에 높은 관심을 가지며, 개인 건강 상태나 복용 약물, 건강 고민 등을 고려한 맞춤형 영양성분 및 식단 가이드가 필요한 임산부<br>- 예시: 임신성 당뇨, 고혈압, 철분 결핍 등 합병증을 겪고 있는 경우<br>- 예시: 약물을 복용 중이거나 복약 정보에 따라 특정 영양 성분 조절이 필요한 경우<br>2. 고객의 필요성<br>- 임신 삼분기별로 변화하는 영양 요구를 반영한 정확하고 신뢰할 수 있는 섭취 가이드가 필요함<br>- 약물-영양소 간 상호작용을 함께 고려한 개인 맞춤형 안내가 부족한 상황임<br>- 임산부는 ‘무엇을, 어떻게, 얼마나’ 섭취해야 하는지에 대한 명확하고 실행 가능한 정보를 요구함<br>- 기존 서비스는 일반화된 정보에 그쳐 개별 맞춤 가이드를 제공하지 못하므로, 개인 건강 정보 기반의 추천 시스템이 필수적임* |
| (2) 기존연구와의 비교 | **기존 서비스와 차별점**<br>기존 임산부 관련 앱들은 주로 일반적인 정보 제공, 전문가 상담, 기록 기능 위주로 구성되어 있으며, 사용자가 직접 질문하거나 정보를 검색해야 원하는 내용을 얻는 방식이다. 일부 앱은 매주 아기 발달 정보, 출산 준비물 리스트 등을 제공하지만, **개인의 건강 상태와 임신 주차에 따른 맞춤형 정보는 부족**한 편이다.<br><br>이에 비해 본 서비스는 사용자의 건강 정보(질환, 임신 주차, 약물 복용 등)를 바탕으로 **자동화된 맞춤형 영양 성분 추천과 식단 가이드를 제공**한다. 사용자가 별도로 질문하지 않아도 현재 상태에 맞는 정보가 사전 제공되며, 실시간으로 권장 영양소와 주의 성분, 식단 예시를 카드 형태로 확인할 수 있다.<br><br>예를 들어, 임신 12주차에 접어든 사용자는 태반 형성을 돕기 위한 철분 섭취 가이드를 자동으로 제공받을 수 있고, 복용 중인 약물이 비타민 B12 흡수를 저해하는 경우 주의 카드도 함께 표시되어 보다 정밀한 영양 관리가 가능하다.<br><br>**본 서비스의 장점**<br>1. **자동화된 개인 맞춤형 정보 제공**: 일반적인 정보에 그치지 않고, 사용자의 건강 상태와 임신 주차를 기반으로 한 **즉시 활용 가능한 가이드**를 자동 제공하여 정보 탐색의 번거로움을 줄여준다.<br>2. **심층적이고 통합적인 영양 관리**: 단순 추천을 넘어, **약물-영양소 상호작용**과 개인 건강 고민을 종합 반영하여 보다 정밀한 맞춤형 가이드를 제공한다. |
| (3) 제안 내용 | 1. 식단–영양소–영양제 연결형 상세 가이드 제공: 사용자 건강 상태 및 복약 정보를 바탕으로, 섭취해야 할 영양소와 피해야 할 성분을 연결하여 설명하고, 금기 사항과 복약 주의사항까지 함께 안내함<br>2. 임신 주차와 개인 건강 기록(복약 정보, 건강 고민, 임신 합병증 여부 등)에 기반한 섭취 가이드를 자동 생성하여, 개인 상황에 맞는 정보를 실시간 제공함<br>3. 영양소 추천 결과를 반영해 맞춤형 식단을 구성하고, 각 식사에 포함된 성분과 섭취 이유를 함께 안내하는 상세 식단 가이드를 제공함<br>4. 텍스트 정보만으로 부족한 경우를 보완하기 위해, 사용자의 건강 관심 키워드 기반 YouTube 영상 추천 기능을 통해 정보 탐색을 유도하고 앱 내 재생 기능을 제공함 |
| (4) 기대효과 및 의의 | 본 프로젝트는 임산부의 건강 관리와 영양 섭취에 있어 기존 시스템의 한계를 넘어, 개인 건강 상태와 임신 주차를 반영한 **맞춤형 정보 제공**에 중점을 둔다.<br>특히, 삼분기별 변화하는 영양 요구와 개별 건강 관심사를 반영하여 **영양소 추천과 식단 가이드**를 자동 생성함으로써, 보다 정확하고 체계적인 영양 관리가 가능하다.<br>이를 통해 임산부가 겪는 복잡한 정보 탐색과 영양 설계의 부담을 줄이고, 실질적인 건강 관리에 도움을 줄 수 있다는 점에서 **현실적인 활용 가치와 사회적 의의**를 갖는다. |
| (5) 주요 기능 리스트 | **복약과 영양의 통합 관리**<br>1. OCR 기반 복약 정보 수집, 파싱 및 DB화<br>2. 약물–영양소 간 상호작용 분석 및 충돌 알림 제공<br>3. 사용자 개인 복약/영양제 정보 조회 기능 제공<br><br>**개인 맞춤형 가이드 제공**<br>1. 임신 주차, 건강 상태 등 사용자 정보 입력 및 수정 기능<br>2. 보유 정보를 바탕으로 프롬프트 엔지니어링을 활용한 맞춤 복용 가이드 생성<br><br>**신뢰성 있는 정보 기반 설계**<br>1. 검증된 데이터셋을 활용한 RAG 구축 및 설명 카드 자동 생성<br>2. 영양성분 및 약품 관련 상세 정보 열람 기능<br><br>**가이드 콘텐츠 확장 기능**<br>1. 사용자 관심 키워드를 기반으로 한 유튜브 영상 추천 및 앱 내 재생 기능 제공 |

<br>
 
# Project-Design & Implementation
| 항목 | 내용 |
|:---|:---|
| (1) 요구사항 정의 | 임산부 대상의 복약 기반 맞춤형 영양 가이드를 제공하기 위해, 기능별 요구사항, 클래스 구조, 사용자 흐름, DB 설계를 바탕으로 요구사항을 정의하였다.<br><br> **1. 기능별 상세 요구사항**<br>(1) 기능 요구사항<br>- 건강 정보 입력 (임신 여부, 주차, 질환, 건강고민 등): 사용자는 임신 여부, 주차, 질환, 건강 고민 등의 건강 정보를 입력할 수 있어야 하며, 시스템은 이를 복약 정보 분석 및 영양소 추천의 기준값으로 활용할 수 있어야 한다.<br>- 복약 정보 입력 및 OCR 기반 약물 성분 추출: 사용자는 약봉투 이미지를 업로드할 수 있어야 하며, 시스템은 해당 이미지에서 약물명과 성분 정보를 OCR을 통해 자동 추출하고, 이를 기반으로 성분 추천에 활용할 수 있어야 한다.<br>- 사용자 복약정보와 건강 상태에 따라 필터링된 영양소 정보를 시각적으로 구분 :시스템은 사용자 복약 정보와 건강 상태에 따라 권장 또는 주의가 필요한 영양소 정보를 필터링하고, 이를 시각적으로 구분하여 사용자에게 한눈에 제공해야 한다.<br>- 추천 영양성분 상세 설명 카드 제공: 시스템은 추천된 영양 성분에 대해 복용 이유와 주의사항을 포함한 설명 카드 형태로 정보를 제공해야 하며, 사용자에게 신뢰도 높은 가이드를 제시해야 한다.<br>- RAG 기반 식단 가이드 및 보충 가이드 제공: 시스템은 사용자의 건강 정보와 권장 영양소를 바탕으로 RAG 기반 식단 예시 및 보충 가이드를 자동 생성하여 실제 섭취 계획에 활용할 수 있도록 해야 한다.<br>- 관심 키워드 기반 YouTube 영상 추천 및 재생: 시스템은 사용자의 건강 관심 키워드를 바탕으로 관련된 YouTube 영상을 추천하고, 앱 내에서 재생할 수 있도록 구현해야 한다.<br><br>(2) 비기능 요구사항<br>- 시스템은 사용자의 건강 정보, 복약 이력, 콘텐츠 선호도 등 민감한 정보를 안전하게 보호해야 하며, 모든 데이터는 암호화된 형태로 저장되고 외부에 노출되지 않아야 한다.<br>- OCR 처리, 추천 로직, RAG 기반 응답 등 주요 기능은 모바일 환경에서도 원활하게 작동할 수 있도록 최적화되어야 하며, 식단 생성 및 설명 카드 응답은 5초 이내에 반환되도록 설계해야 한다.<br>- 시스템은 향후 건강 관심사, 식단 DB, 추천 콘텐츠 등 기능 확장을 고려하여 유연하고 모듈화된 구조를 가져야 한다.<br>- 사용자는 복잡하지 않고 직관적인 UI를 통해 필요한 정보를 쉽게 탐색할 수 있어야 하며, 텍스트 크기, 색상 대비, 버튼 배치 등은 모바일 접근성 가이드라인을 충족하여 다양한 환경에서 누구나 서비스를 이용할 수 있도록 해야 한다.<br><br><br>![유스케이스 다이어그램](https://raw.githubusercontent.com/Jppin/CapstoneReport/main/images/UseCase.png) <br><br> **2.클래스 및 DB 설계 요약**<br>- 핵심 클래스는 User, Medicine, Nutrient, GuideText, Recommendation, FoodGuide, Video로 구성되며, 각 기능별 역할에 따라 분리됨<br><br>![ERD](https://raw.githubusercontent.com/Jppin/CapstoneReport/main/images/ERD.png)<br>**-핵심 클래스 및 테이블 구조 상세 설명**<br> 1.User(사용자정보)<br>&ensp;-역할: 임산부 사용자의 기본 정보와 임신 상태(임신 여부, 주차), 건강 상태(운동 수준, 입덧 수준)를 관리하며, 관심 키워드 배열을 통해 콘텐츠 추천에 활용<br>2.Medicine (복약 정보)<br>&ensp;-역할: 사용자가 복용 중인 약물 정보를 저장하며, OCR을 통해 인식된 약물명과 성분 배열 관리<br>&ensp;-관계: User 테이블과 1:N 관계로 한 사용자가 여러 약물을 등록 가능<br>3. Nutrient (영양소 정보)<br>&ensp;-역할: 영양소의 기본 정보, 효능, 권장 임신 주차 및 함께 복용 시 주의해야 할 약물/상태 정보 제공<br>&ensp;-특징: recommended_during 필드는 해당 영양소가 특히 권장되는 임신 주차 범위를 배열로 저장<br>4.GuideText (가이드 텍스트)<br>&ensp;-역할: 특정 영양소에 대한 설명 텍스트와 사용자 맥락에 맞는 권장 이유를 저장<br>&ensp;-관계: Nutrient와 연결되어 영양소별 맞춤형 설명 제공<br>5.Recommendation (추천 정보)<br>&ensp;-역할: 임신 주차별로 권장되는 영양소 목록을 관리<br>&ensp;-설계 특징: 임신 주차 범위를 기준으로 해당 시기에 필요한 영양소 ID 배열 저장<br>6.FoodGuide (식단 가이드)<br>&ensp;-역할: 권장 식단 정보와 각 식사에 포함된 영양소 및 함량 정보 제공<br>&ensp;-데이터 구조: nutrients는 {nutrient_id → amount} 형식의 맵으로 구성되어 특정 식단에 포함된 영양소 함량 표현<br>7.Video (영상 콘텐츠)<br>&ensp;-역할: 건강 키워드 기반으로 추천할 유튜브 영상 정보 관리<br>&ensp;-활용: 사용자의 관심 키워드와 매칭하여 관련 영상 콘텐츠 제공<br>|
| (2) 전체 시스템 구성 | 본 시스템은 React Native 기반 모바일 앱과 Node.js 기반 백엔드 서버로 구성되며, 사용자의 건강 정보 및 약물 복용 이력을 바탕으로 맞춤형 영양 성분 추천과 식단 가이드를 제공한다. 복약 정보는 OCR을 통해 자동 수집되며, **LangChain 기반 RAG 구조와 GPT API를 활용해** 개인화된 안내 문장을 생성한다.<br><br>전체 시스템은 사용자의 입력 → 서버 처리 → 외부 API 활용 → 결과 반환이라는 흐름을 바탕으로 구성되어 있다. 사용자가 앱에서 입력하거나 업로드한 정보는 Node.js 서버로 전달되며, 서버는 OCR 결과와 사용자의 데이터를 기반으로 성분 분석 및 영양소 추천을 수행하며, 필요에 따라 **OpenAI GPT API, LangChain, YouTube Data API** 등의 외부 API를 호출해 사용자 맞춤형 식단과 콘텐츠를 생성한다. 각 기능은 독립된 모듈로 구성되어 있으며, 전처리-분석-생성의 단계가 모듈 간 흐름을 따라 작동한다.<br><br>**<주요 구성 요소 및 역할>**<br>**- React Native 앱**: 사용자 정보 입력, 약물 이미지 업로드, 권장/주의 영양소 및 섭취 가이드 확인 UI 제공<br>**- Node.js + Express 서버**: OCR 결과 처리, 성분 분석, 추천 로직 실행 및 RAG 기반 식단 생성 기능 처리<br>**- MongoDB Atlas**: 사용자 정보, 복약 이력, 권장·주의 성분, 식단 추천 결과 등 주요 데이터를 저장하는 비정형 데이터베이스<br>**- Redis**: OCR 처리 결과와 추천 결과 데이터를 캐싱하여, 동일 데이터를 반복적으로 요청하는 경우 시스템 성능을 최적화,사용자가 앱을 사용할 때 실시간으로 세션 상태를 관리 유지<br>**- CLOVA OCR API**: 사용자가 업로드한 약봉투 이미지를 처리하여 약물명, 복용 정보, 주의사항 등을 정확하게 추출하고, 이를 기반으로 추천 성분을 도출<br>**- LangChain + OpenAI GPT-4o API**: 사용자의 건강 상태와 임신 주기, 건강 고민을 반영한 프롬프트를 생성하여, 이에 맞는 맞춤형 섭취 가이드를 작성하고 사용자 요구 사항에 맞는 문서 검색을 통해 더욱 개인화된 가이드를 제공<br>**- Vector DB**: 식단 가이드를 위한 문서 벡터화 및 검색을 위한 임베딩 저장소<br>**- YouTube Data API**: 사용자의 건강 관심 키워드를 기반으로 관련 콘텐츠를 탐색하고 앱 내에서 영상 재생<br><br>**<주요 기능 흐름(색상별)>**<br>각 기능 흐름은 화살표 색상으로 구분되며 다음과 같다:<br>**① 약 보관함 기능 (연두색)**: 이미지 업로드 → OCR → 약물명 파싱 → 성분 매칭<br>**② 식단 생성 기능 (분홍색)**: 권장 성분 + 건강 정보 → RAG 쿼리 → GPT 호출 → 식단 및 설명 카드 반환<br>**③ 영양성분 추천 기능 (노란색)**: 건강 상태 및 관심 키워드 기반 → 성분 도출 및 이유 설명 카드 출력<br><br><br>**시스템 아키텍처**<br>![시스템 아키텍처](https://raw.githubusercontent.com/Jppin/CapstoneReport/main/images/System_Architecture.png) <br>**<시스템 아키텍쳐 이미지 구성요소 부가설명>**<br>**[프론트엔드(모바일앱)]**<br>임산부 사용자는 모바일 앱을 통해 약봉투 이미지 업로드, 건강 정보 및 관심 키워드 입력, 추천 영양소 및 식단 가이드 조회 등의 기능을 사용할 수 있음.<br>**[백앤드 서버]**<br>백엔드는 사용자 요청을 처리하고 개인화된 영양 가이드를 제공하는 역할을 수행함. 주요 구성은 다음과 같음.<br>**1. OCR 모듈**<br>사용자가 업로드한 약봉투 이미지를 CLOVA OCR을 활용해 분석하고, 추출된 텍스트 데이터를 정제하여 데이터베이스에 저장<br>**2. 성분 매칭 모듈**<br>사용자의 복용 및 건강 정보를 기반으로 권장/주의 성분을 도출<br>**3. AI 추천 및 정보 생성 모듈**<br>벡터 DB 기반 RAG 모델을 통해 사용자 상태에 맞는 정보를 탐색한 후, LangChain + GPT-4를 활용하여 식단 가이드, 섭취 이유 설명, 주의사항 등을 생성<br>**4. YouTube 콘텐츠 추천 모듈**<br>YouTube API를 통해 관심 키워드에 맞는 건강 영상을 추천하고 앱 내 재생을 지원<br>|
| (3) 주요 엔진 및 기능 설계 | 본 시스템은 기능 단위가 아닌 모듈 단위로 구현이 구분되어 있으며, 주요 엔진은 **① OCR 기반 복약 정보 처리 모듈과 ② LangChain 기반 RAG 텍스트 생성 모듈**로 나뉜다. 아래는 각 모듈의 목적, 구조, 동작 방식에 대한 설명이다.<br><br><br>**1. OCR 기반 복약 정보 처리 모듈**<br>**목적**<br>사용자가 업로드한 약봉투 이미지를 OCR을 통해 자동으로 처리하여, 텍스트로 추출된 약물 정보를 구조화된 데이터로 변환하고, 이를 내부 약물 성분 DB와 매핑하여 성분 기반 영양소 추천 로직의 입력값으로 활용한다.<br><br>**구성 요소 및 구현 세부사항**<br>- **이미지 업로드**: React Native의 ImagePicker를 통해 사용자가 선택한 약봉투 이미지를 Node.js 서버로 전송하며, 서버에서는 Multer를 통해 이미지를 저장하고 CLOVA API 요청에 사용한다.<br>- **OCR 처리**: NAVER CLOVA OCR API를 사용하여 약물명, 용법, 용량 등의 텍스트 정보를 이미지에서 추출하며, 약봉투의 다양한 인쇄 형태에도 높은 인식률을 유지한다.<br>- **텍스트 파싱**: 정규표현식을 이용해 '품목명', '용법' 등의 정보를 추출하며, 패턴이 불규칙한 경우 GPT-4 기반 후처리를 통해 보완한다. 예: "1일 3회 1정 복용" → { frequency: 3, dosage: 1 }<br>- **DB 매핑 및 상호작용 분석기**: 파싱된 의약품명을 MongoDB에 저장된 사전 DB와 대조해 해당 성분을 조회하고, 이미 복용 중인 약물 성분과의 상호작용 여부를 판단한다. 금기된 영양소 성분은 자동으로 caution 플래그가 부여된다.<br>- **상호작용 점수 기반 추천 로직**: 각 성분 간 상호작용 효과를 점수화하여 +1(증강), -1(저해)로 환산하고, 누적 점수를 기준으로 추천/비추천/중립 성분을 구분한다.<br>- **예시 스키마 설계**: { _id: ObjectId, name: String, components: [String], interactions: { nutrient: String, effect: '증강' or '저해' } } 형태로 구성됨. 사전 구축된 14,562개 약물 데이터 기반.<br><br>**기술적 구현**<br>- OCR 전 정확도 향상을 위한 전처리 (Gaussian 필터, CLAHE, grayscale 변환) 적용<br>- Levenshtein 거리 기반 유사 약물명 검색 알고리즘 적용<br>- 복약 정보 구조화 실패 시, GPT-4에 텍스트 전문을 넘겨 JSON 형태로 재구성<br>- 텍스트 처리 속도를 고려하여 async/await 기반 비동기 처리 구성<br><br>**성능 지표**<br>- OCR 정확도: 95.2% (NAVER CLOVA 공식 벤치마크 기준)<br>- 복용법 구조화 정확도: 89.7% (내부 테스트셋 500건 기준)<br>- 평균 응답 속도: 1.8초/이미지 (AWS t3.medium 환경 기준)<br><br>**기술 스택**:<br> React Native, Node.js, Express, Multer, CLOVA OCR API, MongoDB Atlas, Redis, Axios, GPT-4 API<br><br><br><br>**2. RAG 기반 식단 및 섭취 가이드 생성 모듈**<br>**목적**<br>임산부의 건강 정보, 복약 정보, 권장/주의 성분, 식단 제한사항 등을 종합하여 GPT-4 기반의 식단 프롬프트를 생성하고, LangChain 기반 RAG 구조를 통해 신뢰도 높은 하루 식단(아침/점심/저녁/간식) 및 섭취 가이드를 생성하는 것이 목적이다.<br><br>**구성 요소 및 구현 세부사항**<br>- 사용자 입력 수집: 사용자는 앱을 통해 임신 상태, 임신 주차, 만성질환, 관심 키워드, 제외 식재료, 약봉투 이미지를 입력하거나 업로드하며, 이 데이터는 MongoDB의 UserInfo 및 Medicines 컬렉션에 저장된다.<br>성분 매칭 API 호출: 약물 성분과 건강 정보를 기반으로 식약처 데이터베이스와 매칭하여 권장 성분과 주의 성분을 분류하며, 이 과정은 룰 기반 조건 분기 로직으로 처리된다. 예: ‘임신 후기 + 빈혈 위험’이면 철분은 권장, 비타민 A는 주의 성분으로 분류된다.<br>- 다량·미량 영양소 기준 계산: 사용자의 나이, 임신 주차 등을 고려하여 하루 열량과 탄수화물/단백질/지방 비율을 계산하고, 국가건강정보포털의 자료를 참고하여 미량영양소의 추가 권장량을 추출한다.<br>- 프롬프트 구성: 사용자 정보, 식단 제한사항, 영양 목표 데이터를 종합하여 GPT-4 호출용 프롬프트를 생성하며, 프롬프트 구조에는 건강 상태, 약물 정보, 영양 목표, 식단 테마, 끼니별 구성 요소가 포함된다.<br><br>- 프롬프트 구성 및 RAG 호출: 사용자 정보, 권장·주의 성분, 영양소 목표, 피해야 할 음식, 약물 정보 등을 포함한 자연어 프롬프트를 구성하며, LangChain RetrievalQAChain을 통해 Vector Store에서 전문가 레시피 문서를 검색한 뒤 GPT-4가 이를 참조하여 응답 생성함<br>- **프롬프트 예시**:<br>당신은 임산부 식단 전문가입니다. 아래 사용자 정보를 기반으로 하루 식단(아침/점심/저녁/간식)을 구성해 주세요.<br>- 임신 주차: 32주 / 키: 165cm / 몸무게: 67kg / 질환: 임신성 빈혈, 잇몸 염증 / 약물 성분: ferrous sulfate, acetaminophen / 권장 성분: 철분, 엽산 / 주의 성분: 비타민 A, 오메가-3 / 피해야 할 음식: 익히지 않은 생선, 튀김<br>- 각 끼니마다 추천 메뉴, 섭취 이유, 피해야 할 점, 상태별 조언, 영양 팁을 제공하세요<br><br>**출력 구조화**<br>GPT-4 응답은 JSON 형태로 파싱되어 프론트에 전달됨. 각 끼니(menu)는 메뉴명, 이유, 주의사항, 상태별 팁, 약물 상호작용 등으로 구성<br>예:<br>{ \"breakfast\": { \"menu\": [\"현미죽\", \"계란찜\"], \"reason\": \"철분 보충을 위한 구성\", \"warning\": \"계란은 완전히 익혀서 섭취\", \"tip\": \"빈혈 개선에 효과적인 조합\" } }<br><br>- 응답 파싱 및 전달: GPT-4 응답을 JSON 포맷으로 파싱하고, 프론트엔드에 맞는 형식으로 각 끼니별 식단 정보(추천 메뉴, 설명, 주의사항 등)를 전달한다.<br><br>**기술적 구현**<br>GPT-4 호출을 위한 LangChain PromptTemplate + RetrievalQA 구조 적용<br>사용자 데이터를 기반으로 미량/다량 영양소 자동 계산 함수 구성 (권장섭취량 기준 반영)<br>- 프롬프트 내 조건 분기 및 건강상태/임신 주차에 따른 예외사항 처리 포함<br>- 응답 포맷 일관성 유지를 위해 JSON Schema 강제 체크 적용<br>- 프론트엔드에서 식단 재생성 기능 요청 시 동일 조건 재호출 가능하도록 프롬프트 캐싱 적용 예정<br>**성능 지표**<br>- 식단 프롬프트 생성 시간: 평균 1.3초 (t3.medium 기준)<br>- GPT 응답 안정도: 정상 포맷 응답률 96.8% (샘플 테스트 200회 기준)<br>- 사용자 만족도(파일럿 테스트 기준): 4.6/5 (10명 대상)<br><br>**기술 스택**:<br> React Native, Node.js, Express, MongoDB Atlas, Redis, LangChain, GPT-4 API, Pinecone (Vector DB), Axios<br><br><br><br>모듈 간 연계 구조:<br>OCR 분석 결과에서 도출된 성분이 가이드 생성 모듈과 연결되고, 사용자 초기 입력 정보(건강 고민)는 YouTube 추천 모듈과 연계된다. 세 모듈은 각각 독립적인 흐름을 가지되, 사용자 맞춤형 정보 제공이라는 공통 목적을 향해 함께 동작한다. |
| (4) 주요 기능과 SW 모듈 간 연관성 설명 | 본 시스템은 주요 기능별로 명확히 분리된 소프트웨어 모듈 구조를 가지며, 각각의 기능은 내부 모듈과 1:1 또는 1:N 관계로 매핑된다. 아래는 핵심 기능과 그에 대응하는 주요 모듈 및 구현 흐름이다.<br><br>[기능 1] OCR 기반 복약 정보 등록 및 조회<br>연관 모듈: OCRProcessor, DrugParser, NutrientAnalyzer, MongoDB 연결모듈<br>동작 흐름:<br>- 사용자가 약봉투 이미지를 업로드하면, OCRProcessor가 CLOVA OCR API를 호출하여 텍스트를 추출<br>- 추출된 텍스트를 DrugParser에서 정제하고 약물명을 식별<br>- 해당 약물명은 DB와 매핑되어 성분을 조회하고, NutrientAnalyzer가 사용자 정보와 교차 분석하여 권장/주의 성분을 판별함<br>- 분석 결과는 프론트에 카드 형태로 출력되며, MongoDB에 저장되어 이후 '내 복약함' 탭에서 사용자가 등록 내역을 조회 가능<br><br>[기능 2] 맞춤 복용 가이드 및 식단 생성<br>연관 모듈: LangChain RAG 파이프라인, PromptConstructor, GPTHandler, VectorDBWrapper<br>동작 흐름:<br>- 사용자가 앱 최초 실행 시 입력한 건강 정보(임신 주차, 질환, 건강 고민 등)는 MongoDB에 저장되며, 이후 모든 추천 흐름에서 자동으로 사용됨<br>- 도출된 권장 성분과 함께 PromptConstructor가 LangChain 기반 프롬프트를 구성<br>- VectorDBWrapper는 RAG용 문서를 벡터 검색하고, GPTHandler가 GPT-4o를 호출하여 섭취 가이드 및 식단 예시 문장을 생성함<br>- 응답 결과는 프론트에서 카드 형태로 사용자에게 전달됨<br><br>[기능 3] 건강 관심 키워드 기반 YouTube 영상 추천<br>연관 모듈: KeywordManager, YouTubeFetcher, VideoFormatter, FrontendGridRenderer<br>동작 흐름:<br>- 사용자가 입력한 건강 관심 키워드는 KeywordManager에 저장되며, 백엔드는 이를 기반으로 YouTubeFetcher로 YouTube Data API를 호출<br>- 결과는 VideoFormatter를 통해 썸네일, 제목, 링크 형태로 정제되어 프론트로 전송됨<br>- FrontendGridRenderer는 썸네일 리스트를 출력하고, 클릭 시 앱 내 WebView로 재생함<br>- 사용자가 ‘좋아요’를 누른 영상은 DB에 저장되어 ‘좋아요 탭’에서 다시 확인 가능<br><br>기능 간 통합 및 제어 흐름:<br>- OCR 기능은 섭취 가이드 생성의 입력값을 제공하는 선행 기능이며, 유저 입력 정보는 모든 기능에 걸쳐 공통 기반 데이터로 작동함<br>- YouTube 추천 기능은 가이드/식단 기능과 직접 연결되진 않지만, 건강 관심사 기반 큐레이션 기능으로 사용자 맞춤도와 흥미 유지를 도움<br>- GPT 인터페이스는 단순 API 호출이 아닌, LangChain 기반 프롬프트 생성 – 문서 검색 – 조건 분기 응답의 체계적 구조로 구현되어 있음<br><br>이러한 기능–모듈 매핑을 통해 각 기능은 독립성과 유연성을 확보하면서도, 전체 시스템 흐름 내에서 일관된 데이터 흐름과 사용자 경험을 제공하도록 설계되었다. |
| (5) 기타 | 현재 복약 이미지가 흐리거나 글자가 왜곡된 경우 OCR 정확도에 영향을 줄 수 있어, 향후 유사 샘플 학습 또는 보정 로직 개선을 고려할 예정임 |
<br>
